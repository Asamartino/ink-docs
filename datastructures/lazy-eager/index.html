<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<link rel="stylesheet" href="fonts/fonts.css"><title data-react-helmet="true">Lazy vs. Eager | ink! documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Lazy vs. Eager | ink! documentation"><meta data-react-helmet="true" name="description" content="In the following we explore the differences between the high-level ink_storage::HashMap"><meta data-react-helmet="true" property="og:description" content="In the following we explore the differences between the high-level ink_storage::HashMap"><meta data-react-helmet="true" property="og:url" content="https://github.com/paritytech/ink/ink-docs/datastructures/lazy-eager"><link data-react-helmet="true" rel="shortcut icon" href="/ink-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/paritytech/ink/ink-docs/datastructures/lazy-eager"><link rel="stylesheet" href="/ink-docs/styles.0181aea0.css">
<link rel="preload" href="/ink-docs/styles.93823461.js" as="script">
<link rel="preload" href="/ink-docs/runtime~main.29320646.js" as="script">
<link rel="preload" href="/ink-docs/main.ebd8045a.js" as="script">
<link rel="preload" href="/ink-docs/1.433e589e.js" as="script">
<link rel="preload" href="/ink-docs/2.52762a20.js" as="script">
<link rel="preload" href="/ink-docs/51.077be039.js" as="script">
<link rel="preload" href="/ink-docs/935f2afb.51396d9f.js" as="script">
<link rel="preload" href="/ink-docs/17896441.41e5604e.js" as="script">
<link rel="preload" href="/ink-docs/5d335ed5.13c32f7e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/ink-docs/"><img class="navbar__logo" src="/ink-docs/img/logo-black.svg" alt="ink!"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ink! GitHub</a><a href="https://github.com/paritytech/ink-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docs GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/ink-docs/"><img class="navbar__logo" src="/ink-docs/img/logo-black.svg" alt="ink!"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="menu__link">ink! GitHub</a></li><li class="menu__list-item"><a href="https://github.com/paritytech/ink-docs" target="_blank" rel="noopener noreferrer" class="menu__link">Docs GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/why-rust-for-smart-contracts">Why Rust for Smart Contracts?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/why-webassembly-for-smart-contracts">Why WebAssembly for Smart Contracts?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/how-it-works">How it works â€’ Substrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-vs-solidity">ink! vs. Solidity</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/setup">Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/creating-an-ink-project">Creating an ink! Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/building-your-contract">Compiling Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/running-substrate">Running a Substrate Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/deploy-your-contract">Deploy Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/calling-your-contract">Calling Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/troubleshooting">Troubleshooting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/contract-template">Contract Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/storing-values">Storing Values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/reading-values">Reading Values from Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/mutating-values">Mutating Storage Values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/events">Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/trait-definitions">Trait Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/cross-contract-calling">Cross-Contract Calling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/off-chain-testing">Contract Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/environment-functions">Environment Functions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Macros &amp; Attributes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/constructor">constructor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/message">message</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/event">event</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/anonymous">anonymous</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/implementation">implementation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/namespace">namespace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/payable">Payable Messages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/selector">selector</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/storage">storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-macros-attributes/topic">topic</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Storage &amp; Data Structures</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/datastructures/custom">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/datastructures/hashmap">HashMap</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/ink-docs/datastructures/lazy-eager">Lazy vs. Eager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/datastructures/spread-packed-layout">Spread &amp; Packed</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/datastructures/opting-out">Opting out of Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/datastructures/dynamic-allocation">Dynamic Allocation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/datastructures/custom-datastructure">Your Custom Datastructure</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/examples">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">cargo-contract CLI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/cargo-contract-cli">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Canvas Test Network</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/canvas">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/faq">Frequently Asked Questions</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Lazy vs. Eager</h1></header><div class="markdown"><p>In the following we explore the differences between the high-level <code>ink_storage::collections::HashMap</code>
and the low-level <code>ink_storage::lazy::LazyHashMap</code>. Both provide very similar functionality in that they map some generic key to some storage entity.</p><p>However, their APIs look very different. Whereas the <code>HashMap</code> provides a rich and high-level API that is comparable to that of Rust&#x27;s very own <code>HashMap</code>, the <code>LazyHashMap</code> provides only a fraction of the API and also operates on <code>Option&lt;T&gt;</code> values types instead of <code>T</code> directly. It is more similar Solidity mappings than to Rust&#x27;s <code>HashMap</code>.</p><p>The fundamental difference of both data structures is that <code>HashMap</code> is aware of the keys that have been stored in it and thus can reconstruct exactly which elements and storage regions apply to it. This enables it to provide iteration and automated deletion as well as efficient way to defragment its underlying storage to free some storage space again. This goes very well in the vein of Substrate&#x27;s storage rent model where contracts have to pay for the storage they are using.</p><table><thead><tr><th align="left">Data Structure</th><th align="center">level of abstraction</th><th align="center">caching</th><th align="center">lazy</th><th align="center">element type</th><th align="center">container</th></tr></thead><tbody><tr><td align="left"><code>T</code></td><td align="center">-</td><td align="center">yes</td><td align="center">no</td><td align="center"><code>T</code></td><td align="center">primitive value</td></tr><tr><td align="left"><code>Lazy&lt;T&gt;</code></td><td align="center">high-level</td><td align="center">yes</td><td align="center">yes</td><td align="center"><code>T</code></td><td align="center">single element container</td></tr><tr><td align="left"><code>LazyCell&lt;T&gt;</code></td><td align="center">low-level</td><td align="center">yes</td><td align="center">yes</td><td align="center"><code>Option&lt;T&gt;</code></td><td align="center">single element, no container</td></tr><tr><td align="left"><code>Vec&lt;T&gt;</code></td><td align="center">high-level</td><td align="center">yes</td><td align="center">yes</td><td align="center"><code>T</code></td><td align="center">Rust vector-like container</td></tr><tr><td align="left"><code>LazyIndexMap&lt;T&gt;</code></td><td align="center">low-level</td><td align="center">yes</td><td align="center">yes</td><td align="center"><code>Option&lt;T&gt;</code></td><td align="center">similar to Solidity mapping</td></tr><tr><td align="left"><code>HashMap&lt;K, V&gt;</code></td><td align="center">high-level</td><td align="center">yes</td><td align="center">yes</td><td align="center"><code>V</code> (key type <code>K</code>)</td><td align="center">Rust map-like container</td></tr><tr><td align="left"><code>LazyHashMap&lt;K, V&gt;</code></td><td align="center">low-level</td><td align="center">yes</td><td align="center">yes</td><td align="center"><code>Option&lt;V&gt;</code> (key type <code>K</code>)</td><td align="center">similar to Solidity mapping</td></tr></tbody></table><p>There are many more! For more information about the specifics please take a look into <a href="https://paritytech.github.io/ink/ink_storage/" target="_blank" rel="noopener noreferrer">the <code>ink_storage</code> crate documentation</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="in-summary"></a>In Summary<a aria-hidden="true" tabindex="-1" class="hash-link" href="#in-summary" title="Direct link to heading">#</a></h3><p>TODO</p><p>The new <code>ink_storage</code> crate provides everything you need to operate on your contract&#x27;s storage.
There are low-level and high-level data structures depending on your need of control.
All provided data structures operate lazily on the contract&#x27;s storage and cache their reads and writes for a more gas efficient storage access.
Users should prefer high-level data structures found in the <code>collections</code> module over the low-level data structures found in the <code>lazy</code> module.
For a list of all the new storage data structure visit <a href="https://paritytech.github.io/ink/ink_storage/" target="_blank" rel="noopener noreferrer"><code>ink_storage</code>&#x27;s documentation</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ink-docs/edit/master/docs/datastructures/hashmap-impls.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ink-docs/datastructures/hashmap"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« HashMap</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ink-docs/datastructures/spread-packed-layout"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Spread &amp; Packed Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#in-summary" class="table-of-contents__link">In Summary</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/ink-docs/styles.93823461.js"></script>
<script src="/ink-docs/runtime~main.29320646.js"></script>
<script src="/ink-docs/main.ebd8045a.js"></script>
<script src="/ink-docs/1.433e589e.js"></script>
<script src="/ink-docs/2.52762a20.js"></script>
<script src="/ink-docs/51.077be039.js"></script>
<script src="/ink-docs/935f2afb.51396d9f.js"></script>
<script src="/ink-docs/17896441.41e5604e.js"></script>
<script src="/ink-docs/5d335ed5.13c32f7e.js"></script>
</body>
</html>