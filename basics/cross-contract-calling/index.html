<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="stylesheet" href="fonts/fonts.css"><title data-react-helmet="true">Cross-Contract Calling | ink! documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://github.com/paritytech/ink/ink-docs/basics/cross-contract-calling"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Cross-Contract Calling | ink! documentation"><meta data-react-helmet="true" name="description" content="In ink! contracts it is possible to call ink! messages and ink! constructors. So ink! constructors allow"><meta data-react-helmet="true" property="og:description" content="In ink! contracts it is possible to call ink! messages and ink! constructors. So ink! constructors allow"><link data-react-helmet="true" rel="icon" href="/ink-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/paritytech/ink/ink-docs/basics/cross-contract-calling"><link data-react-helmet="true" rel="alternate" href="https://github.com/paritytech/ink/ink-docs/basics/cross-contract-calling" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/paritytech/ink/ink-docs/basics/cross-contract-calling" hreflang="x-default"><link rel="stylesheet" href="/ink-docs/assets/css/styles.7f8bc528.css">
<link rel="preload" href="/ink-docs/assets/js/runtime~main.cb3ab9b4.js" as="script">
<link rel="preload" href="/ink-docs/assets/js/main.232db674.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ink-docs/"><div class="navbar__logo"><img src="/ink-docs/img/logo-black.svg" alt="ink!" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/ink-docs/img/logo-white.svg" alt="ink!" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>ink! GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/paritytech/ink-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Docs GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/getting-started/setup">Getting started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/ink-docs/basics/contract-template">Basics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/contract-template">Contract Template</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/storing-values">Storing Values</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/reading-values">Reading Values from Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/mutating-values">Mutating Storage Values</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/events">Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/trait-definitions">Trait Definitions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ink-docs/basics/cross-contract-calling">Cross-Contract Calling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/contract-testing">Contract Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/basics/environment-functions">Environment Functions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/macros-attributes">Macros &amp; Attributes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/datastructures/overview">Storage &amp; Data Structures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/examples">Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/cargo-contract-cli">cargo-contract CLI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/canvas">Canvas Test Network</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ink-docs/faq">FAQ</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cross-Contract Calling</h1></header><p>In ink! contracts it is possible to call ink! messages and ink! constructors. So ink! constructors allow
delegation and ink! messages can easily call other ink! messages.
Given another ink! contract like, we can call any of its functions.</p><p>See our <a href="https://github.com/paritytech/ink/blob/master/examples/delegator/lib.rs" target="_blank" rel="noopener noreferrer"><code>delegator example contract</code></a>
for an elaborate example which uses cross-contract calling.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="how-it-works">How it Works<a class="hash-link" href="#how-it-works" title="Direct link to heading">â€‹</a></h3><p>In order to deploy the delegator smart contract we first
have to manually put the code of the other contract, receive
its code hash from the signalled event and put their code hash
into our calling smart contract.</p><p>The calling contract looks like this:</p><div class="codeBlockContainer_J+bg language-rust theme-code-block"><div class="codeBlockContent_csEI rust"><pre tabindex="0" class="prism-code language-rust codeBlock_rtdJ thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_storage::Lazy;</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">use other_contract::OtherContract;</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">//--snip--</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink(storage)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">struct MyContract {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    /// The other contract.</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    other_contract: Lazy&lt;OtherContract&gt;,</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">impl MyContract {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    /// Instantiate `MyContract with the given</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    /// sub-contract codes and some initial value.</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(constructor)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub fn new(</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        other_contract_code_hash: Hash,</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    ) -&gt; Self {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        let other_contract = OtherContract::new(1337)</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            .endowment(total_balance / 4)</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            .code_hash(other_contract_code_hash)</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            .instantiate()</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            .expect(&quot;failed at instantiating the `OtherContract` contract&quot;);</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        Self {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            other_contract</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    /// Calls the other contract.</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(message)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub fn call_other_contract(&amp;self) -&gt; i32 {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        self.other_contract.get_value()</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">//--snip--</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>It&#x27;s <code>Cargo.toml</code> contains</p><div class="codeBlockContainer_J+bg language-toml theme-code-block"><div class="codeBlockContent_csEI toml"><pre tabindex="0" class="prism-code language-toml codeBlock_rtdJ thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9a86fd"><span class="token plain">other_contract = { path = &quot;other_contract&quot;, default-features = false, features = [&quot;ink-as-dependency&quot;] }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>other_contract/Cargo.toml</code> contains this:</p><div class="codeBlockContainer_J+bg language-toml theme-code-block"><div class="codeBlockContent_csEI toml"><pre tabindex="0" class="prism-code language-toml codeBlock_rtdJ thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9a86fd"><span class="token plain">[features]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">ink-as-dependency = []</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Tells the ink! code generator to <strong>always</strong> or <strong>never</strong>
compile the smart contract as if it was used as a dependency of another ink!
smart contract.</p><p>The <code>other_contract/lib.rs</code>:</p><div class="codeBlockContainer_J+bg language-rust theme-code-block"><div class="codeBlockContent_csEI rust"><pre tabindex="0" class="prism-code language-rust codeBlock_rtdJ thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">pub mod other_contract {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    /// Storage for the other contract.</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct OtherContract {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        value: i32,</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl OtherContract {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Initializes the contract.</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(value: i32) -&gt; Self {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Self { value }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current state.</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get_value(&amp;self) -&gt; i32 {</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ink-docs/edit/master/docs/basics/cross-contract-calling.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ink-docs/basics/trait-definitions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Trait Definitions</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ink-docs/basics/contract-testing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contract Testing</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How it Works</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/ink-docs/assets/js/runtime~main.cb3ab9b4.js"></script>
<script src="/ink-docs/assets/js/main.232db674.js"></script>
</body>
</html>