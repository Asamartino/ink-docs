<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<link rel="stylesheet" href="fonts/fonts.css"><title data-react-helmet="true">#[ink::contract] | ink! documentation</title><meta data-react-helmet="true" property="og:url" content="https://github.com/paritytech/ink/ink-docs/macros-attributes/contract"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="#[ink::contract] | ink! documentation"><meta data-react-helmet="true" name="description" content="This macro is the entry point for writing ink! smart contracts."><meta data-react-helmet="true" property="og:description" content="This macro is the entry point for writing ink! smart contracts."><link data-react-helmet="true" rel="shortcut icon" href="/ink-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/paritytech/ink/ink-docs/macros-attributes/contract"><link data-react-helmet="true" rel="alternate" href="https://github.com/paritytech/ink/ink-docs/macros-attributes/contract" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/paritytech/ink/ink-docs/macros-attributes/contract" hreflang="x-default"><link rel="stylesheet" href="/ink-docs/assets/css/styles.8fba0fc5.css">
<link rel="preload" href="/ink-docs/assets/js/runtime~main.847b2318.js" as="script">
<link rel="preload" href="/ink-docs/assets/js/main.1cf9cbf2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ink-docs/"><img src="/ink-docs/img/logo-black.svg" alt="ink!" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/ink-docs/img/logo-white.svg" alt="ink!" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>ink! GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/paritytech/ink-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Docs GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/ink-docs/"><img src="/ink-docs/img/logo-black.svg" alt="ink!" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/ink-docs/img/logo-white.svg" alt="ink!" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title"></b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="menu__link"><span>ink! GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://github.com/paritytech/ink-docs" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Docs GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/why-rust-for-smart-contracts">Why Rust for Smart Contracts?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/why-webassembly-for-smart-contracts">Why WebAssembly for Smart Contracts?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/how-it-works">How it Works â€’ Substrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/ink-vs-solidity">ink! vs. Solidity</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/setup">Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/creating-an-ink-project">Creating an ink! Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/building-your-contract">Compile Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/running-substrate">Run a Substrate Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/deploy-your-contract">Deploy Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/calling-your-contract">Call Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/getting-started/troubleshooting">Troubleshooting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/contract-template">Contract Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/storing-values">Storing Values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/reading-values">Reading Values from Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/mutating-values">Mutating Storage Values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/events">Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/trait-definitions">Trait Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/cross-contract-calling">Cross-Contract Calling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/contract-testing">Contract Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/basics/environment-functions">Environment Functions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Macros &amp; Attributes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes">Overview</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/ink-docs/macros-attributes/contract">#[ink::contract]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/anonymous">#[ink(anonymous)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/constructor">#[ink(constructor)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/event">#[ink(event)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/impl">#[ink(impl)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/message">#[ink(message)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/namespace">#[ink(namespace = &quot;â€¦&quot;)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/payable">#[ink(payable)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/selector">#[ink(selector = &quot;â€¦&quot;)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/storage">#[ink(storage)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/topic">#[ink(topic)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/chain-extension">#[ink::chain_extension]</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Storage &amp; Data Structures</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/datastructures/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/datastructures/hashmap">Working with Datastructures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/datastructures/spread-packed-layout">Spread vs. Packed</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/datastructures/opting-out">Opt out of Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/datastructures/dynamic-allocation">Dynamic Storage Allocator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/datastructures/custom-datastructure">Custom Datastructures</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/examples">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">cargo-contract CLI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/cargo-contract-cli">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Canvas Test Network</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/canvas">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/ink-docs/faq">Frequently Asked Questions</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">#[ink::contract]</h1></header><p>This macro is the entry point for writing ink! smart contracts.</p><p>If you are a beginner trying to learn ink! we recommend you to check out
our extensive <a href="https://substrate.dev/substrate-contracts-workshop/#/" target="_blank" rel="noopener noreferrer">ink! workshop</a>.</p><p><strong>Note:</strong> In all below examples we will be using <code>ink_lang</code> crate aliased as just <code>ink</code>.
You can do this yourself by adding the following line to your code:
<code>use ink_lang as ink;</code></p><header><h1 class="h1Heading_27L5">Description</h1></header><p>The macro does analysis on the provided smart contract code and generates
proper code.</p><p>ink! smart contracts can compile in several different modes.
There are two main compilation modes using either</p><ul><li>on-chain mode: <code>no_std</code> + WebAssembly as target</li><li>off-chain mode: <code>std</code></li></ul><p>We generally use the on-chain mode for actual smart contract deployment
whereas we use the off-chain mode for smart contract testing using the
off-chain environment provided by the <code>ink_env</code> crate.</p><header><h1 class="h1Heading_27L5">Usage</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="header-arguments"></a>Header Arguments<a class="hash-link" href="#header-arguments" title="Direct link to heading">#</a></h2><p>The <code>#[ink::contract]</code> macro can be provided with some additional comma-separated
header arguments:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dynamic_storage_allocator-bool"></a><code>dynamic_storage_allocator: bool</code><a class="hash-link" href="#dynamic_storage_allocator-bool" title="Direct link to heading">#</a></h3><p>Tells the ink! code generator to allow usage of ink!&#x27;s built-in dynamic
storage allocator.</p><ul><li><code>true</code>: Use the dynamic storage allocator provided by ink!.</li><li><code>false</code>: Do NOT use the dynamic storage allocator provided by ink!.</li></ul><p>This feature is generally only needed for smart contracts that try to model
their data in a way that contains storage entites within other storage
entities.</p><p>Contract writers should try to write smart contracts that do not depend on the
dynamic storage allocator since enabling it comes at a cost of increased Wasm
file size. Although it will enable interesting use cases. Use it with care!</p><p>An example for this is the following type that could potentially be used
within a contract&#x27;s storage struct definition:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">// A storage vector of storage vectors.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_storage as storage;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">type VectorOfVectors = storage::Vec&lt;storage::Vec&lt;i32&gt;&gt;;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Usage Example:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract(dynamic_storage_allocator = true)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod my_contract {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyStorage;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl MyStorage {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { MyStorage {} }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Default value:</strong> <code>false</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="compile_as_dependency-bool"></a><code>compile_as_dependency: bool</code><a class="hash-link" href="#compile_as_dependency-bool" title="Direct link to heading">#</a></h3><p>Tells the ink! code generator to <strong>always</strong> or <strong>never</strong>
compile the smart contract as if it was used as a dependency of another ink!
smart contract.</p><p>Normally this flag is only really useful for ink! developers who
want to inspect code generation of ink! smart contracts.
The author is not aware of any particular practical use case for users that
makes use of this flag but contract writers are encouraged to disprove this.</p><p>Note that it is recommended to make use of the built-in crate feature
<code>ink-as-dependency</code> to flag smart contract dependencies listed in a contract&#x27;s
<code>Cargo.toml</code> as actual dependencies to ink!.</p><p><strong>Usage Example:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract(compile_as_dependency = true)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod my_contract {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyStorage;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl MyStorage {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { MyStorage {} }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Default value:</strong> Depends on the crate feature propagation of <code>Cargo.toml</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="env-impl-environment"></a><code>env: impl Environment</code><a class="hash-link" href="#env-impl-environment" title="Direct link to heading">#</a></h3><p>Tells the ink! code generator which environment to use for the ink! smart contract.
The environment must implement the <code>Environment</code> (defined in <code>ink_env</code>) trait and provides
all the necessary fundamental type definitions for <code>Balance</code>, <code>AccountId</code> etc.</p><p>When using a custom <code>Environment</code> implementation for a smart contract all types
that it exposes to the ink! smart contract and the mirrored types used in the runtime
must be aligned with respect to SCALE encoding and semantics.</p><p><strong>Usage Example:</strong></p><p>Given a custom <code>Environment</code> implementation:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">pub struct MyEnvironment;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">impl ink_env::Environment for MyEnvironment {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    const MAX_EVENT_TOPICS: usize = 3;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    type AccountId = u64;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    type Balance = u128;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    type Hash = [u8; 32];</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    type Timestamp = u64;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    type BlockNumber = u32;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    type ChainExtension = ::ink_env::NoChainExtension;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>A user might implement their ink! smart contract using the above custom <code>Environment</code>
implementation as demonstrated below:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract(env = MyEnvironment)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod my_contract {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyEnvironment;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">   </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl ink_env::Environment for MyEnvironment {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        const MAX_EVENT_TOPICS: usize = 3;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        type AccountId = u64;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        type Balance = u128;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        type Hash = [u8; 32];</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        type Timestamp = u64;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        type BlockNumber = u32;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        type ChainExtension = ::ink_env::NoChainExtension;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyStorage;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl MyStorage {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { MyStorage {} }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    // ...</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Default value:</strong> <code>DefaultEnvironment</code> defined in <code>ink_env</code> crate.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="anaylsis"></a>Anaylsis<a class="hash-link" href="#anaylsis" title="Direct link to heading">#</a></h2><p>The <code>#[ink::contract]</code> macro fully analyses its input smart contract
against invalid arguments and structure.</p><p>Some example rules include but are not limited to:</p><ul><li><p>There must be exactly one <code>#[ink(storage)]</code> struct.</p><p>   This struct defines the layout of the storage that the ink! smart contract operates on.
The user is able to use a variety of built-in facilities, combine them in various ways
or even provide their own implementations of storage data structures.</p><p>   For more information visit the <code>ink_storage</code> crate documentation.</p><p>   <strong>Example:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { Flipper { value: false } }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>There must be at least one <code>#[ink(constructor)]</code> defined method.</p><p>   Methods flagged with <code>#[ink(constructor)]</code> are special in that they are dispatchable
upon contract instantiation. A contract may define multiple such constructors which
allow users of the contract to instantiate a contract in multiple different ways.</p><p>   <strong>Example:</strong></p><p>   Given the <code>Flipper</code> contract definition above we add an <code>#[ink(constructor)]</code>
as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>There must be at least one <code>#[ink(message)]</code> defined method.</p><p>   Methods flagged with <code>#[ink(message)]</code> are special in that they are dispatchable
upon contract invocation. The set of ink! messages defined for an ink! smart contract
define its API surface with which users are allowed to interact.</p><p>   An ink! smart contract can have multiple such ink! messages defined.</p><p>   <strong>Note:</strong></p><ul><li><p>An ink! message with a <code>&amp;self</code> receiver may only read state whereas an ink! message
with a <code>&amp;mut self</code> receiver may mutate the contract&#x27;s storage.</p><p><strong>Example:</strong></p><p>Given the <code>Flipper</code> contract definition above we add some <code>#[ink(message)]</code> definitions
as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Payable Messages:</strong></p><p>An ink! message by default will reject calls that additional fund the smart contract.
Authors of ink! smart contracts can make an ink! message payable by adding the <code>payable</code>
flag to it. An example below:</p><p>Note that ink! constructors are always implicitly payable and thus cannot be flagged
as such.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(payable)] // You can either specify payable out-of-line.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message, payable)] // ... or specify payable inline.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>Controlling the messages selector:</strong></p><p>Every ink! message and ink! constructor has a unique selector with which the
message or constructor can be uniquely identified within the ink! smart contract.
These selectors are mainly used to drive the contract&#x27;s dispatch upon calling it.</p><p>An ink! smart contract author can control the selector of an ink! message or ink!
constructor using the <code>selector</code> flag. An example is shown below:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(selector = &quot;0xDEADBEEF&quot;)] // Works on constructors as well.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(selector = &quot;0xCAFEBABE&quot;)] // You can either specify selector out-of-line.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">       </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message, selector = &quot;0xFEEDBEEF&quot;)] // ... or specify selector inline.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="interacting-with-the-contract-executor"></a>Interacting with the Contract Executor<a class="hash-link" href="#interacting-with-the-contract-executor" title="Direct link to heading">#</a></h2><p>The <code>ink_env</code> crate provides facitilies to interact with the contract executor that
connects ink! smart contracts with the outer world.</p><p>For example it is possible to query the current call&#x27;s caller via:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_env;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">ink_env::test::run_test::&lt;ink_env::DefaultEnvironment, _&gt;(|_| {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    let caller = ink_env::caller::&lt;ink_env::DefaultEnvironment&gt;();</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    let _caller = caller;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Ok(())</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}).unwrap();</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>However, ink! provides a much simpler way to interact with the contract executor
via its environment accessor. An example below:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain"> </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">mod greeter {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Greeter;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl Greeter {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new() -&gt; Self {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            let caller = Self::env().caller();</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            let message = format!(&quot;thanks for instantiation {:?}&quot;, caller);</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ink_env::debug_println(&amp;message);</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Greeter {}</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message, payable)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn fund(&amp;mut self) {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            let caller = self.env().caller();</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            let value = self.env().transferred_balance();</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            let message = format!(&quot;thanks for the funding of {:?} from {:?}&quot;, value, caller);</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ink_env::debug_println(&amp;message);</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="events"></a>Events<a class="hash-link" href="#events" title="Direct link to heading">#</a></h2><p>An ink! smart contract may define events that it can emit during contract execution.
Emitting events can be used by third party tools to query information about a contract&#x27;s
execution and state.</p><p>The following example ink! contract shows how an event <code>Transferred</code> is defined and
emitted in the <code>#[ink(constructor)]</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain"> use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain"> </span></span><span class="token-line" style="color:#9a86fd"><span class="token plain"> #[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain"> mod erc20 {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     /// Defines an event that is emitted every time value is transferred.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     #[ink(event)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     pub struct Transferred {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         from: Option&lt;AccountId&gt;,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         to: Option&lt;AccountId&gt;,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         value: Balance,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     pub struct Erc20 {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         total_supply: Balance,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         // more fields ...</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     impl Erc20 {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         pub fn new(initial_supply: Balance) -&gt; Self {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             let caller = Self::env().caller();</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             Self::env().emit_event(Transferred {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 from: None,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 to: Some(caller),</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 value: initial_supply,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             });</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             Self { total_supply: initial_supply }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         pub fn total_supply(&amp;self) -&gt; Balance {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             self.total_supply</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">     }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain"> }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-flipper"></a>Example: Flipper<a class="hash-link" href="#example-flipper" title="Direct link to heading">#</a></h2><p>The below code shows the complete implementation of the so-called Flipper
ink! smart contract.
For us it acts as the &quot;Hello, World!&quot; of the ink! smart contracts because
it is minimal while still providing some more or less useful functionality.</p><p>It controls a single <code>bool</code> value that can be either <code>false</code> or <code>true</code>
and allows the user to flip this value using the <code>Flipper::flip</code> message
or retrieve the current value using <code>Flipper::get</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><pre tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">pub mod flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Creates a new flipper smart contract initialized with the given value.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(init_value: bool) -&gt; Self {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Self { value: init_value }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value of the Flipper&#x27;s bool.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value of the Flipper&#x27;s bool.</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></span><span class="token-line" style="color:#9a86fd"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/ink-docs/edit/master/docs/macros-attributes/contract.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ink-docs/macros-attributes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ink-docs/macros-attributes/anonymous"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">#[ink(anonymous)] Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#header-arguments" class="table-of-contents__link">Header Arguments</a><ul><li><a href="#dynamic_storage_allocator-bool" class="table-of-contents__link"><code>dynamic_storage_allocator: bool</code></a></li><li><a href="#compile_as_dependency-bool" class="table-of-contents__link"><code>compile_as_dependency: bool</code></a></li><li><a href="#env-impl-environment" class="table-of-contents__link"><code>env: impl Environment</code></a></li></ul></li><li><a href="#anaylsis" class="table-of-contents__link">Anaylsis</a></li><li><a href="#interacting-with-the-contract-executor" class="table-of-contents__link">Interacting with the Contract Executor</a></li><li><a href="#events" class="table-of-contents__link">Events</a></li><li><a href="#example-flipper" class="table-of-contents__link">Example: Flipper</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/ink-docs/assets/js/runtime~main.847b2318.js"></script>
<script src="/ink-docs/assets/js/main.1cf9cbf2.js"></script>
</body>
</html>