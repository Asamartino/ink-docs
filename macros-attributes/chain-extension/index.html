<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-macros-attributes/chain-extension">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="stylesheet" href="fonts/fonts.css"><title data-rh="true">#[ink::chain_extension] | ink! documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://github.com/paritytech/ink/ink-docs/macros-attributes/chain-extension"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="#[ink::chain_extension] | ink! documentation"><meta data-rh="true" name="description" content="In the default configuration of the contracts-pallet a smart contract can only interact with the runtime"><meta data-rh="true" property="og:description" content="In the default configuration of the contracts-pallet a smart contract can only interact with the runtime"><link data-rh="true" rel="icon" href="/ink-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/paritytech/ink/ink-docs/macros-attributes/chain-extension"><link data-rh="true" rel="alternate" href="https://github.com/paritytech/ink/ink-docs/macros-attributes/chain-extension" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/paritytech/ink/ink-docs/macros-attributes/chain-extension" hreflang="x-default"><link rel="stylesheet" href="/ink-docs/assets/css/styles.dc1b410d.css">
<link rel="preload" href="/ink-docs/assets/js/runtime~main.c5545c8a.js" as="script">
<link rel="preload" href="/ink-docs/assets/js/main.4e7ec25f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ink-docs/"><div class="navbar__logo"><img src="/ink-docs/img/logo-black.svg" alt="ink!" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/ink-docs/img/logo-white.svg" alt="ink!" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ink! GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/paritytech/ink-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docs GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/getting-started/setup">Getting started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/basics/contract-template">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/ink-docs/macros-attributes">Macros &amp; Attributes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/contract">#[ink::contract]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/anonymous">#[ink(anonymous)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/constructor">#[ink(constructor)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/event">#[ink(event)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/impl">#[ink(impl)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/message">#[ink(message)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/namespace">#[ink(namespace = &quot;…&quot;)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/payable">#[ink(payable)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/selector">#[ink(selector = S:u32)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/storage">#[ink(storage)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ink-docs/macros-attributes/topic">#[ink(topic)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ink-docs/macros-attributes/chain-extension">#[ink::chain_extension]</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/datastructures/overview">Storage &amp; Data Structures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/examples">Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/cargo-contract-cli">cargo-contract CLI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/canvas">Canvas Test Network</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ink-docs/faq">FAQ</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/ink-docs/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Macros &amp; Attributes</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">#[ink::chain_extension]</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>#[ink::chain_extension]</h1></header><p>In the default configuration of the <code>contracts-pallet</code> a smart contract can only interact with the runtime
via its well defined set of basic smart contract interface. This API already allows a whole variety of
interaction between the <code>contracts-pallet</code> and the executed smart contract. For example it is possible
to call and instantiate other smart contracts on the same chain, emit events, query context information
or run built-in cryptographic hashing procedures.</p><p>If this basic set of features is not enough for a particular Substrate built blockchain it is possible
to easily extend this API using the so-called chain extension feature.</p><p><strong>Note:</strong> The ink! repository contains <a href="https://github.com/paritytech/ink/tree/master/examples/rand-extension" target="_blank" rel="noopener noreferrer">the <code>rand-extension</code> example</a>.
This is a complete example of a chain extension implemented in both ink! and Substrate.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="structure">Structure<a class="hash-link" href="#structure" title="Direct link to heading">​</a></h2><p>The interface consists of an error code that indicates lightweight errors
as well as the definition of some chain extension methods.</p><p>The overall structure follows that of a simple Rust trait definition.
The error code is defined as an associated type definition of the trait definition.
The methods are defined as associated trait methods without implementation.</p><p>Chain extension methods must not have a <code>self</code> receiver such as <code>&amp;self</code> or <code>&amp;mut self</code>
and must have inputs and output that implement SCALE codec. Their return value follows
specific rules that can be altered using the <code>handle_status</code> and <code>returns_result</code> attributes
which are described in more detail below.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="usage">Usage<a class="hash-link" href="#usage" title="Direct link to heading">​</a></h2><p>Usually the chain extension definition using this proc. macro is provided
by the author of the chain extension in a separate crate.
ink! smart contracts using this chain extension simply depend on this crate
and use its associated environment definition in order to make use of
the methods provided by the chain extension.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="attributes">Attributes<a class="hash-link" href="#attributes" title="Direct link to heading">​</a></h2><p>There are three different attributes with which the chain extension methods
can be flagged:</p><table><thead><tr><th align="left">Attribute</th><th align="center">Required</th><th align="left">Default Value</th><th align="center">Description</th></tr></thead><tbody><tr><td align="left"><code>ink(extension = N: u32)</code></td><td align="center">Yes</td><td align="left">-</td><td align="center">Determines the unique function ID of the chain extension method.</td></tr><tr><td align="left"><code>ink(handle_status = flag: bool)</code></td><td align="center">Optional</td><td align="left"><code>true</code></td><td align="center">Assumes that the returned status code of the chain extension method always indicates success and therefore always loads and decodes the output buffer of the call.</td></tr><tr><td align="left"><code>ink(returns_result = flag: bool)</code></td><td align="center">Optional</td><td align="left"><code>true</code></td><td align="center">By default chain extension methods are assumed to return a <code>Result&lt;T, E&gt;</code> in the output buffer. Using <code>returns_result = false</code> this check is disabled and the chain extension method may return any other type.</td></tr></tbody></table><p>As with all ink! attributes multiple of them can either appear in a contiguous list:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#2a2734;color:#9a86fd"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> ink_lang </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> ink</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">MyChainExtension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 5, handle_status = false, returns_result = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">key_access_for_account</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>…or as multiple standalone ink! attributes applied to the same item:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#2a2734;color:#9a86fd"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> ink_lang </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> ink</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">MyChainExtension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 5)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(returns_result = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">key_access_for_account</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="details-handle_status">Details: <code>handle_status</code><a class="hash-link" href="#details-handle_status" title="Direct link to heading">​</a></h2><p>Default value: <code>true</code></p><p>By default all chain extension methods return a <code>Result&lt;T, E&gt;</code> where <code>E: From&lt;Self::ErrorCode&gt;</code>.
The <code>Self::ErrorCode</code> represents the error code of the chain extension.
This means that a smart contract calling such a chain extension method first queries the returned
status code of the chain extension method and only loads and decodes the output if the returned
status code indicates a successful call.
This design was chosen as it is more efficient when no output besides the error
code is required for a chain extension call. When designing a chain extension try to utilize the
error code to return errors and only use the output buffer for information that does not fit in
a single <code>u32</code> value.</p><p>A chain extension method that is flagged with <code>handle_status = false</code> assumes that the returned error code
will always indicate success. Therefore it will always load and decode the output buffer and loses
the <code>E: From&lt;Self::ErrorCode</code> constraint for the call.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="details-returns_result">Details: <code>returns_result</code><a class="hash-link" href="#details-returns_result" title="Direct link to heading">​</a></h2><p>Default value: <code>true</code></p><p>By default chain extension methods are assumed to return a value of type <code>Result&lt;T, E&gt;</code> through the
output buffer. Using <code>returns_result = false</code> this check is disabled and the chain extension method may return
any other type.</p><p>Note that if a chain extension method is attributed with <code>returns_result = false</code>
and with <code>handle_status = true</code> it will still return a value of type <code>Result&lt;T, Self::ErrorCode&gt;</code>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="usage-handle_status--returns_result">Usage: <code>handle_status</code> + <code>returns_result</code><a class="hash-link" href="#usage-handle_status--returns_result" title="Direct link to heading">​</a></h2><p>Use both <code>handle_status = false</code> and <code>returns_result = false</code> for the same chain extension method
if a call to it may never fail and never returns a <code>Result</code> type.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="combinations">Combinations<a class="hash-link" href="#combinations" title="Direct link to heading">​</a></h2><p>Due to the possibility to flag a chain extension method with <code>handle_status</code> and <code>returns_result</code>
there are 4 different cases with slightly varying semantics:</p><table><thead><tr><th align="center"><code>handle_status</code></th><th align="center"><code>returns_result</code></th><th align="left">Effects</th></tr></thead><tbody><tr><td align="center"><code>true</code></td><td align="center"><code>true</code></td><td align="left">The chain extension method is required to return a value of type <code>Result&lt;T, E&gt;</code> where <code>E: From&lt;Self::ErrorCode&gt;</code>. A call will always check if the returned status code indicates success and only then will load and decode the value in the output buffer.</td></tr><tr><td align="center"><code>true</code></td><td align="center"><code>false</code></td><td align="left">The chain extension method may return any non-<code>Result</code> type. A call will always check if the returned status code indicates success and only then will load and decode the value in the output buffer. The actual return type of the chain extension method is still <code>Result&lt;T, Self::ErrorCode&gt;</code> when the chain extension method was defined to return a value of type <code>T</code>.</td></tr><tr><td align="center"><code>false</code></td><td align="center"><code>true</code></td><td align="left">The chain extension method is required to return a value of type <code>Result&lt;T, E&gt;</code>. A call will always assume that the returned status code indicates success and therefore always load and decode the output buffer directly.</td></tr><tr><td align="center"><code>false</code></td><td align="center"><code>false</code></td><td align="left">The chain extension method may return any non-<code>Result</code> type. A call will always assume that the returned status code indicates success and therefore always load and decode the output buffer directly.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="error-code">Error Code<a class="hash-link" href="#error-code" title="Direct link to heading">​</a></h2><p>Every chain extension defines exactly one <code>ErrorCode</code> using the following syntax:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#2a2734;color:#9a86fd"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> ink_lang </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> ink</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">MyChainExtension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">MyErrorCode</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// more definitions ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The defined <code>ErrorCode</code> must implement <code>FromStatusCode</code> which should be implemented as a
more or less trivial conversion from the <code>u32</code> status code to a <code>Result&lt;(), Self::ErrorCode&gt;</code>.
The <code>Ok(())</code> value indicates that the call to the chain extension method was successful.</p><p>By convention an error code of <code>0</code> represents success.
However, chain extension authors may use whatever suits their needs.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-definition">Example: Definition<a class="hash-link" href="#example-definition" title="Direct link to heading">​</a></h2><p>In the below example a chain extension is defined that allows its users to read and write
from and to the runtime storage using access privileges:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#2a2734;color:#9a86fd"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> ink_lang </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> ink</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Custom chain extension to read to and write from the runtime.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">RuntimeReadWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Reads from runtime storage.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Actually returns a value of type `Result&lt;Vec&lt;u8&gt;, Self::ErrorCode&gt;`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// #[ink(extension = 1, returns_result = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// fn read(key: &amp;[u8]) -&gt; Vec&lt;u8&gt;;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Reads from runtime storage.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Returns the number of bytes read and up to 32 bytes of the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// read value. Unused bytes in the output are set to 0.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// If the runtime storage cell stores a value that requires more than</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// 32 bytes.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// This requires `ReadWriteError` to implement `From&lt;ReadWriteErrorCode&gt;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// and may potentially return any `Self::ErrorCode` through its return value.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 2)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Writes into runtime storage.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Actually returns a value of type `Result&lt;(), Self::ErrorCode&gt;`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 3, returns_result = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Returns the access allowed for the key for the caller.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Assumes to never fail the call and therefore always returns `Option&lt;Access&gt;`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 4, returns_result = false, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Access</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Unlocks previously aquired permission to access key.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// If the permission was not granted.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Assumes the call to never fail and therefore does _NOT_ require `UnlockAccessError`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// to implement `From&lt;Self::ErrorCode&gt;` as in the `read_small` method above.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 5, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">BufferTooSmall</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> required_bytes</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  reason</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">ReadWrite</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">ReadOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">WriteOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">chain_extension</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">FromStatusCode</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from_status_code</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">match</span><span class="token plain"> status_code </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">1</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">2</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">3</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      _ </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unknown status code&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>All the error types and other utility types used in the chain extension definition
above are often required to implement various traits such as SCALE&#x27;s <code>Encode</code> and <code>Decode</code>
as well as <code>scale-info</code>&#x27;s <code>TypeInfo</code> trait.</p><p>A full example of the above chain extension definition can be seen
<a href="https://github.com/paritytech/ink/blob/017f71d60799b764425334f86b732cc7b7065fe6/crates/lang/macro/tests/ui/chain_extension/simple.rs" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-environment">Example: Environment<a class="hash-link" href="#example-environment" title="Direct link to heading">​</a></h2><p>In order to allow ink! smart contracts to use the above defined chain extension it needs
to be integrated into an <code>Environment</code> definition as shown below:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#2a2734;color:#9a86fd"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">RuntimeReadWrite</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token punctuation" style="color:#6c6783">{</span><span class="token class-name">Environment</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">DefaultEnvironment</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> </span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">usize</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">AccountId</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">AccountId</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Balance</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Balance</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Hash</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Hash</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">BlockNumber</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">BlockNumber</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Timestamp</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Timestamp</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ChainExtension</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">RuntimeReadWrite</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Above we defined the <code>CustomEnvironment</code> which defaults to ink!&#x27;s <code>DefaultEnvironment</code>
for all constants and types but the <code>ChainExtension</code> type which is assigned to our newly
defined chain extension.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-usage">Example: Usage<a class="hash-link" href="#example-usage" title="Direct link to heading">​</a></h2><p>An ink! smart contract can use the above defined chain extension through the <code>Environment</code>
definition defined in the last example section using the <code>env</code> macro parameter as
shown below.</p><p>Note that chain extension methods are accessible through <code>Self::extension()</code> or
<code>self.extension()</code>. For example as in <code>Self::extension().read(..)</code> or <code>self.extension().read(..)</code>.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx" style="background-color:#2a2734;color:#9a86fd"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> ink_lang </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> ink</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::contract(env = CustomEnvironment)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">mod</span><span class="token plain"> </span><span class="token module-declaration namespace" style="opacity:0.7">read_writer</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> ink_lang </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> ink</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(storage)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriter</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">ReadWriter</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(constructor)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">read</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            value</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Access</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Custom chain extension to read to and write from the runtime.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">RuntimeReadWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 1, returns_result = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 2)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 3, returns_result = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 4, returns_result = false, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Access</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(extension = 5, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">BufferTooSmall</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> required_bytes</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         reason</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[derive(scale::Encode, scale::Decode, scale_info::TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token class-name">ReadWrite</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token class-name">ReadOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token class-name">WriteOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">chain_extension</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">FromStatusCode</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from_status_code</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token keyword" style="color:#ffcc99">match</span><span class="token plain"> status_code </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">1</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">2</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">3</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 _ </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unknown status code&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> </span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">usize</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">AccountId</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">AccountId</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Balance</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Balance</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Hash</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Hash</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">BlockNumber</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">BlockNumber</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Timestamp</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Timestamp</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ChainExtension</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">RuntimeReadWrite</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="technical-limitations">Technical Limitations<a class="hash-link" href="#technical-limitations" title="Direct link to heading">​</a></h2><ul><li>Due to technical limitations it is not possible to refer to the <code>ErrorCode</code> associated type
using <code>Self::ErrorCode</code> anywhere within the chain extension and its defined methods.
Instead chain extension authors should directly use the error code type when required.
This limitation might be lifted in future versions of ink!.</li><li>It is not possible to declare other chain extension traits as super traits or super
chain extensions of another.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ink-docs/edit/master/docs/macros-attributes/chain-extension.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ink-docs/macros-attributes/topic"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">#[ink(topic)]</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ink-docs/datastructures/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#structure" class="table-of-contents__link toc-highlight">Structure</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#attributes" class="table-of-contents__link toc-highlight">Attributes</a></li><li><a href="#details-handle_status" class="table-of-contents__link toc-highlight">Details: <code>handle_status</code></a></li><li><a href="#details-returns_result" class="table-of-contents__link toc-highlight">Details: <code>returns_result</code></a></li><li><a href="#usage-handle_status--returns_result" class="table-of-contents__link toc-highlight">Usage: <code>handle_status</code> + <code>returns_result</code></a></li><li><a href="#combinations" class="table-of-contents__link toc-highlight">Combinations</a></li><li><a href="#error-code" class="table-of-contents__link toc-highlight">Error Code</a></li><li><a href="#example-definition" class="table-of-contents__link toc-highlight">Example: Definition</a></li><li><a href="#example-environment" class="table-of-contents__link toc-highlight">Example: Environment</a></li><li><a href="#example-usage" class="table-of-contents__link toc-highlight">Example: Usage</a></li><li><a href="#technical-limitations" class="table-of-contents__link toc-highlight">Technical Limitations</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/ink-docs/assets/js/runtime~main.c5545c8a.js"></script>
<script src="/ink-docs/assets/js/main.4e7ec25f.js"></script>
</body>
</html>